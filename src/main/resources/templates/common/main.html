<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/layout}"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
>
<head>
    <title>Match Play</title>
</head>
<body>
    <div layout:fragment="content">
        <div sec:authorize="!isAuthenticated()">
            <h1 align="center">ğŸ¸ OOí´ëŸ½ì— ì˜¤ì‹ ê±¸ í™˜ì˜í•©ë‹ˆë‹¤. ğŸ¸</h1>
            <p>í™ë³´ í¬ìŠ¤í„°? ë¨¸ì´ëŸ°ê±°</p>
        </div>
        <div sec:authorize="isAuthenticated()">
            <div>
                <p>ê¸ˆì¼ ì¶œì„ ëª©ë¡ : <span th:text="${att_size}"></span>/<span th:text="${mem_size}"></span>ëª…</p>
                <div class="d-flex flex-wrap justify-content-start">
                    <div th:each="att : ${all_att}"
                         class="text-center border rounded p-2 m-1"
                         style="width: 90px;">
                        <span th:text="${att}"></span>
                    </div>
                </div>
            </div>
            <br>
            <p>ì½”íŠ¸ ì´ìš©í˜„í™©</p>
            <div th:if="${att}">
                <button id="attendCancelButton" type="button" class="btn btn-primary btn-sm">ì¶œì„ ì·¨ì†Œ</button>
            </div>
            <div th:unless="${att}">
                <button id="attendButton" type="button" class="btn btn-primary btn-sm">ì¶œì„ í•˜ê¸°</button>
            </div>
            <button onclick="console.log(stomp.connected ? 'ì—°ê²°ë¨ âœ…' : 'ëŠê¹€ âŒ')">ì†Œì¼“ ìƒíƒœ í™•ì¸</button>

        </div>
        <div sec:authorize="isAuthenticated()">
            <script th:inline="javascript">
                // ì„œë²„ê°€ ë‚´ë ¤ì¤€ ì¶œì„ ì—¬ë¶€(Boolean)
                const isAttended = /*[[${att}]]*/ false;   // ë¹„ë¡œê·¸ì¸/ë„ì´ë©´ false
                if (isAttended) {
                  // ì¶œì„ ìƒíƒœë©´: í”Œë˜ê·¸ ON + ì—°ê²° ì‹œë„
                  window.attendanceOn();   // set attendance=true + connectWS()
                } else {
                  // ë¯¸ì¶œì„/ì¶œì„ì·¨ì†Œë©´: í”Œë˜ê·¸ OFF + ì—°ê²° ì°¨ë‹¨
                  window.attendanceOff();  // set attendance=false + disconnectWS()
                }
            </script>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
        <script type="text/javascript" th:src="@{/js/common/main.js}"></script>
    </div>

</body>
</html>