<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sports.match.match.model.dao.MatchDao">

    <select id="getAttMemList" resultType="com.sports.match.match.model.dto.AttMemberListDto">
        SELECT
        a.mem_id, a.mem_name, a.grade
        FROM MEMBER a
        JOIN attendance b ON a.mem_no = b.mem_no
        WHERE
        b.att_date = #{today}
    </select>

    <insert id="getMatchId" parameterType="map">
        INSERT INTO match_info () VALUES ();
        <selectKey keyProperty="matchId" resultType="int" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
    </insert>

    <insert id="insertMatchHistoryList">
        INSERT INTO history (match_id, court_id, result, mem_id, mem_name, score, team)
        VALUES
        <foreach collection="list" item="dto" separator=",">
            (#{dto.matchId}, #{dto.courtId}, #{dto.result}, #{dto.memId}, #{dto.memName}, #{dto.score}, #{dto.team})
        </foreach>
    </insert>
</mapper>