//회원 정보
CREATE TABLE member (
  mem_no INT AUTO_INCREMENT PRIMARY KEY,
  mem_id VARCHAR(100) NOT NULL,
  mem_pw VARCHAR(255) NOT NULL,
  mem_name VARCHAR(100) NOT NULL,
  mem_tel VARCHAR(50),
  mem_email VARCHAR(150),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  mem_role VARCHAR(20) DEFAULT 'ROLE_USER',
  grade VARCHAR(20),
  approved INT DEFAULT 0,
  profile_img VARCHAR(255) DEFAULT 'default_profile.png'
);

//출석 정보
CREATE TABLE attendance (
  att_id INT AUTO_INCREMENT PRIMARY KEY,             -- 출석 고유번호
  mem_no INT NOT NULL,                               -- 회원 고유번호 (FK)
  att_date DATE NOT NULL,                            -- 출석 날짜 (출석 기준용)
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,    -- 출석을 누른 실제 시간 기록
  CONSTRAINT fk_member_attendance
    FOREIGN KEY (mem_no) REFERENCES member(mem_no)
    ON DELETE CASCADE,                               -- 회원 삭제 시 출석 기록도 삭제
  CONSTRAINT unique_attendance UNIQUE (mem_no, att_date)  -- 같은 날 중복 출석 방지
);

CREATE TABLE match_info (
  match_id INT AUTO_INCREMENT PRIMARY KEY,         -- 경기 고유번호
  match_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP   -- 경기 종료 기록 시각
);

CREATE TABLE history (
  history_no INT AUTO_INCREMENT PRIMARY KEY,  -- 고유 PK
  match_id   INT NOT NULL,                    -- 어떤 경기인지 (FK)
  court_id	 INT NOT NULL,
  result 	 CHAR(1) CHECK (result IN ('W','L')),
  mem_id     VARCHAR(100) NOT NULL,           -- 플레이어 ID
  mem_name   VARCHAR(100) NOT NULL,           -- 플레이어 이름
  score      INT NOT NULL,                    -- 개인 점수
  team       VARCHAR(10) NOT NULL,            -- A or B 팀
  matched_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP, -- 기록 생성 시각
  CONSTRAINT fk_match FOREIGN KEY (match_id) REFERENCES match_info(match_id)
);